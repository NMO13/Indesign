#include "ImageDownload.jsx"//renderImages(null);function renderImages(images) {    //var url = "https://bilder.ottoversand.at/asset/mmo/‚baur_format_p/16191566.jpg";    //var url = "https://www.dropbox.com/s/1xny3ot2xmcwwh9/BottleBag_FG.jpg";    //var url = "https://www.dropbox.com/s/1xny3ot2xmcwwh9/BottleBag_FG.jpg?dl=1";    var url = "http://www.werbemittelhersteller.com/filemanager/do.php?down=1547";    render (url);    }function render(url) {    var directory = downloadImages(url);    image = processDownloadedFile(directory);        var page = document.pages.item(0);    var rect = page.rectangles.add();    //rect.geometricBounds = [0, 100, 100, 200];    rect.place(image);    rect.fit (FitOptions.FRAME_TO_CONTENT);    rect.fit (FitOptions.PROPORTIONALLY);    rect.fit (FitOptions.CENTER_CONTENT);        var xOffset = (rect.geometricBounds[3] - rect.geometricBounds[1]) / 2;    //rect.geometricBounds = [rect.geometricBounds[0], rect.geometricBounds[1] + xOffset, rect.geometricBounds[2], rect.geometricBounds[3] + xOffset];    rect.move([100, 0]);    }function processDownloadedFile(directory) {    var folder = new Folder(directory);    var files = folder.getFiles();    if(files.length == 0) {        alert("The download of the image file was not successful");        return;        }    for(i = 0; i < files.length; i++) {        var file = new File(files[i]);        var extension = file.name.split('.').pop();        if(extension == "zip") {            unzip(file, directory);            var image = findImage(directory);            if(image == null)                alert("Image was not found in zip");            return image;           }                   else if(extension =="jpg" | extension == "jpeg")        {            file.open("r");            return image;            }        }    alert("Unrecognized file type");    }function findImage(directory) {    var folder = new Folder(directory);    var files = folder.getFiles();    if(files.length == 0) {        alert("The download of the image file was not successful");        return;        }        for(i = 0; i < files.length; i++) {        var file = files[i];        var extension = file.name.split('.').pop();        if(file instanceof File) {            if(extension =="jpg" | extension == "jpeg") {                file.open("r");                return file;            }        }        else if(file instanceof Folder) {            var file = findImage(file);            return file;        }    }    return null;    }function unzip(file, directory) {    try {            app.doScript('do shell script "unzip -o /Users/admin/Desktop/images/04456_IMG1.zip -d ' + directory + '"', ScriptLanguage.applescriptLanguage);        }        catch(e)        {            alert(e);            throw e;        }    }